{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "base-event",
  "title": "Base Analytics Event Schema",
  "description": "Common schema for all analytics events in the Onboarding Portal",
  "type": "object",
  "required": [
    "schema_version",
    "event",
    "timestamp",
    "platform",
    "properties",
    "context"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the schema"
    },
    "event": {
      "type": "string",
      "pattern": "^[a-z]+\\.[a-z_]+$",
      "description": "Event name in namespace.action_object format"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the event occurred"
    },
    "user_id": {
      "type": "string",
      "pattern": "^hash_[a-f0-9]{64}$",
      "description": "Hashed user identifier (SHA-256)"
    },
    "session_id": {
      "type": "string",
      "pattern": "^sess_[a-zA-Z0-9]{10,}$",
      "description": "Session identifier"
    },
    "platform": {
      "type": "string",
      "enum": ["web", "mobile", "api"],
      "description": "Platform where the event originated"
    },
    "properties": {
      "type": "object",
      "description": "Event-specific properties (defined by event type)"
    },
    "context": {
      "type": "object",
      "description": "Additional context about the event",
      "properties": {
        "user_agent": {
          "type": "string",
          "maxLength": 500
        },
        "ip_address_hash": {
          "type": "string",
          "pattern": "^hash_[a-f0-9]{16}$",
          "description": "Hashed IP address"
        },
        "screen_resolution": {
          "type": "string",
          "pattern": "^\\d+x\\d+$"
        },
        "timezone": {
          "type": "string",
          "pattern": "^[A-Za-z_]+/[A-Za-z_]+$"
        },
        "referrer": {
          "type": "string",
          "format": "uri"
        },
        "environment": {
          "type": "string",
          "enum": ["development", "staging", "production"]
        },
        "server_timestamp": {
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}

   PASS  Tests\Unit\BasicSetupTest
  ✓ environment is testing                                               0.06s  
  ✓ database is sqlite memory                                            0.01s  
  ✓ cache driver is array                                                0.01s  
  ✓ basic assertion                                                      0.01s  

   PASS  Tests\Unit\GamificationOCRPointsTest
  ✓ ocr point constants are defined correctly                            0.73s  
  ✓ calculate ocr points with minimum scenario                           0.08s  
  ✓ calculate ocr points with medium confidence                          0.09s  
  ✓ calculate ocr points with high confidence                            0.06s  
  ✓ calculate ocr points with good quality                               0.11s  
  ✓ calculate ocr points with excellent quality                          0.13s  
  ✓ calculate ocr points with validation success                         0.06s  
  ✓ calculate ocr points with partial validation                         0.06s  
  ✓ calculate ocr points with complex documents                          0.07s  
  ✓ calculate ocr points with progressive bonus                          0.09s  
  ✓ calculate ocr points maximum scenario                                0.07s  
  ✓ ocr points are added to beneficiary progress                         0.15s  
  ✓ non ocr actions still work correctly                                 0.10s  
  ✓ backward compatibility maintained                                    0.13s  

   FAIL  Tests\Unit\OpenTelemetryIntegrationTest
  ✓ opentelemetry packages are installed                                 0.02s  
  ✓ otel configuration exists                                            0.01s  
  ⨯ tracing service provider is registered                               0.01s  
  ✓ tracing middleware exists                                            0.01s  
  ✓ otel can create tracer when enabled                                  0.02s  

   PASS  Tests\Unit\Services\BrazilianDocumentServiceTest
  ✓ it validates valid cpf                                               0.03s  
  ✓ it validates cpf without formatting                                  0.01s  
  ✓ it rejects invalid cpf                                               0.01s  
  ✓ it rejects cpf with all same digits in production                    0.01s  
  ✓ it allows test cpf in non production                                 0.01s  
  ✓ it rejects cpf with wrong length
  ✓ it parses date with two digit year correctly                         0.02s  
  ✓ it parses various date formats                                       0.02s  
  ✓ it rejects invalid dates                                             0.02s  
  ✓ it normalizes strings preserving brazilian characters                0.01s  
  ✓ it calculates string similarity correctly                            0.01s  
  ✓ it validates rg format                                               0.01s  
  ✓ it validates cnh format                                              0.01s  
  ✓ it formats cpf correctly
  ✓ it cleans cpf correctly                                              0.02s  
  ✓ it handles edge case dates correctly                                 0.01s  

   PASS  Tests\Unit\Services\EnhancedOCRServiceTest
  ✓ it can initialize with proper configuration                          0.11s  
  ✓ it returns cached result when available                              0.05s  
  ✓ it blocks processing when budget limit reached                       0.07s  
  ✓ it falls back to tesseract when textract fails                       0.06s  
  ✓ it validates quality correctly                                       0.05s  
  ✓ it calculates quality score correctly                                0.07s  
  ✓ it processes key value pairs correctly                               0.05s  
  ✓ it estimates pages correctly                                         0.04s  
  ✓ it generates correct cache keys                                      0.07s  

   PASS  Tests\Unit\Services\HealthAIServiceTest
  ✓ it can analyze health query successfully                             0.03s  
  ✓ it handles api failures gracefully                                   0.01s  
  ✓ it can generate recommendations by risk level                        0.01s  
  ✓ it can detect preexisting conditions                                 0.01s  
  ✓ it provides fallback recommendations for different risk levels       0.01s  
  ✓ it parses ai response with malformed json                            0.01s  
  ✓ it validates request timeout handling                                0.02s  

   FAIL  Tests\Unit\Services\OCRCostMonitoringTest
  ⨯ it can track textract api usage costs                                0.06s  
  ⨯ it can monitor daily spending limits                                 0.05s  
  ✓ it can generate cost optimization recommendations                    0.06s  
  ⨯ it can track cost per document type                                  0.04s  
  ✓ it can forecast monthly costs                                        0.05s  
  ✓ it can alert on cost anomalies                                       0.06s  

   FAIL  Tests\Unit\Services\OCRServiceTest
  ✓ it can extract rg data from ocr result                               0.06s  
  ✓ it can extract cnh data from ocr result                              0.19s  
  ✓ it can extract cpf data from ocr result                              0.07s  
  ⨯ it can extract address proof data                                    0.10s  
  ⨯ it validates identity document correctly                             0.06s  
  ✓ it detects name mismatch in validation                               0.09s  
  ✓ it detects birth date mismatch                                       0.06s  
  ⨯ it validates cpf document correctly                                  0.07s  
  ⨯ it detects cpf mismatch                                              0.08s  
  ⨯ it validates address document with warnings                          0.05s  
  ✓ it detects expired cnh document                                      0.09s  
  ✓ it normalizes strings correctly for comparison                       0.07s  
  ✓ it parses dates in various formats                                   0.07s  

   FAIL  Tests\Unit\Services\OptimizedTextractServiceTest
  ⨯ it processes document with cost optimization                         0.06s  
  ✓ it falls back to tesseract when cost limit reached                   0.09s  
  ⨯ it detects document types correctly                                  0.06s  
  ⨯ it selects optimal features based on document type                   0.06s  
  ⨯ it handles throttling exception with exponential backoff             0.06s  
  ⨯ it formats brazilian documents correctly                             0.08s  
  ⨯ it calculates quality metrics correctly                              0.07s  
  ⨯ it handles unsupported document exception                            0.05s  

   FAIL  Tests\Unit\Services\TextractCostOptimizationServiceTest
  ⨯ can process document within limits
  ⨯ cannot process document exceeding daily limit
  ⨯ estimate processing cost
  ⨯ optimize document
  ⨯ optimize batch processing
  ⨯ monitor costs with alerts
  ⨯ record actual cost
  ⨯ get cost optimization summary

   FAIL  Tests\Unit\Services\TextractServiceTest
  ⨯ it can process rg document with textract
  ⨯ it can process cpf document with textract
  ⨯ it can process cnh document with textract
  ⨯ it can process address proof with textract
  ⨯ it handles textract service exceptions gracefully
  ⨯ it validates textract confidence scores
  ⨯ it can extract tables from textract response
  ⨯ it handles portuguese accents correctly
  ⨯ it validates brazilian document patterns

   PASS  Tests\Unit\Services\ValidationUtilityServiceTest
  ✓ it validates ocr confidence scores                                   0.04s  
  ✓ it validates ocr confidence with custom thresholds                   0.01s  
  ✓ it validates email addresses                                         0.01s  
  ✓ it validates brazilian phone numbers                                 0.08s  
  ✓ it validates brazilian cep                                           0.03s  
  ✓ it sanitizes text input                                              0.02s  
  ✓ it validates user registration data                                  0.01s  
  ✓ it handles empty confidence scores                                   0.12s  
  ✓ it handles invalid confidence scores                                 0.03s  
  ✓ it provides appropriate recommendations                              0.09s  
  ✓ it normalizes email to lowercase                                     0.01s  
  ✓ it handles phone with formatting                                     0.13s  

   FAIL  Tests\Feature\AdminRBACTest
  ⨯ admin can access all user management endpoints                       0.15s  
  ⨯ manager has limited user management access                           0.11s  
  ⨯ regular user cannot access admin endpoints                           0.11s  
  ⨯ admin can manage roles and permissions                               0.09s  
  ⨯ manager cannot manage roles                                          0.12s  
  ⨯ admin can perform bulk operations                                    0.10s  
  ⨯ manager has limited bulk operations                                  0.09s  
  ⨯ admin actions are logged in audit trail                              0.12s  
  ⨯ permission escalation attempts are blocked                           0.11s  
  ⨯ admin can view system configuration                                  0.09s  
  ⨯ admin can update system configuration                                0.10s  
  ⨯ non admin users cannot access system config                          0.12s  
  ⨯ admin can generate comprehensive reports                             0.09s  
  ⨯ manager has limited report access                                    0.15s  
  ⨯ role inheritance works correctly                                     0.16s  
  ⨯ session based permission validation                                  0.11s  
  ⨯ concurrent admin operations are handled safely                       0.07s  

   FAIL  Tests\Feature\Api\AuthenticationEdgeCasesTest
  ✓ login prevents sql injection                                         0.47s  
  ✓ login sanitizes device name                                          0.92s  
  ✓ login with very long email                                           0.08s  
  ⨯ login with unicode email                                             0.54s  
  ✓ login with formatted cpf                                             0.99s  
  ✓ concurrent login requests                                            3.71s  
  ⨯ registration prevents duplicate users                                1.18s  
  ✓ account recovery after lockout                                       1.24s  
  ⨯ registration rollback on error                                       0.48s  
  ⨯ malformed json request                                               0.05s  
  ✓ empty request body                                                   0.05s  
  ✓ registration with null values                                        0.08s  
  ✓ invalid token format                                                 0.05s  
  ⨯ handles database connection failure                                  0.50s  
  ✓ cors headers present                                                 0.06s  

   PASS  Tests\Feature\Api\AuthenticationTest
  ✓ user can login with valid credentials                                1.07s  
  ✓ user cannot login with invalid credentials                           1.06s  
  ✓ login requires email and password                                    0.05s  
  ✓ login returns registration step for incomplete user                  1.27s  
  ✓ login fails with inactive account                                    1.57s  
  ✓ account locks after multiple failed attempts                         5.03s  
  ✓ login rate limiting                                                  3.79s  
  ✓ check email availability                                             0.06s  
  ✓ check cpf availability                                               0.26s  
  ✓ authenticated user can logout                                        0.20s  
  ✓ authenticated user can logout from all devices                       0.05s  
  ✓ authenticated user can get user details                              0.07s  
  ✓ unauthenticated user cannot access protected routes                  0.06s  
  ✓ authenticated user can refresh token                                 0.06s  
  ✓ user can login with cpf                                              1.01s  

   FAIL  Tests\Feature\Api\CriticalFixesIntegrationTest
  ⨯ it handles gamification system repair integration                   11.14s  
  ⨯ it processes health questionnaire unified flow
  ⨯ it handles concurrent gamification operations
  ⨯ it validates badge assignment system repair
  ⨯ it handles health questionnaire domain transitions
  ⨯ it maintains state consistency across components
  ⨯ it handles api failure recovery gracefully
  ⨯ it validates performance under load
  ⨯ it validates security measures in fixes
  ⨯ it validates lgpd compliance in fixes
  ⨯ it validates monitoring and alerting integration
[2025-08-27T19:13:57.543Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:13:59.178Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:02.560Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:07.862Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:10.947Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:13.469Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:16.007Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:17.987Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:19.442Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:21.325Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db

   FAIL  Tests\Feature\Api\DataConsistencyIntegrationTest
  ⨯ data consistency during concurrent updates
  ⨯ transaction rollback on failure
  ⨯ cascade updates across related models
  ⨯ event driven data synchronization
  ⨯ cache consistency with database
  ⨯ data integrity during bulk operations
  ⨯ referential integrity constraints
  ⨯ optimistic locking for concurrent updates
  ⨯ data validation consistency across endpoints
  ⨯ lgpd data consistency and privacy
[2025-08-27T19:14:23.105Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:24.693Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:26.460Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:28.050Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:30.389Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:32.608Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:34.593Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:36.681Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:39.336Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:40.998Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db

   FAIL  Tests\Feature\Api\DocumentProcessingPipelineTest
  ⨯ complete document processing pipeline
  ⨯ ocr fallback mechanism
  ⨯ batch document processing
  ⨯ document validation pipeline
  ⨯ document processing performance metrics
  ⨯ document type specific processing
  ⨯ document processing error handling
  ⨯ document processing with network failures
  ⨯ document caching strategy
  ⨯ concurrent document uploads

   FAIL  Tests\Feature\Api\GamificationConcurrencyTest
  ⨯ concurrent point accumulation maintains consistency
  ⨯ concurrent badge awards prevent duplicates
  ⨯ concurrent leaderboard updates maintain correct rankings
  ⨯ concurrent level progression consistency
  ⨯ concurrent streak updates maintain accuracy
  ⨯ concurrent achievement tracking integrity
  ⨯ high frequency api requests maintain data integrity
  ⨯ database constraint violations are handled gracefully
  ⨯ memory and performance under concurrent load
  ⨯ transaction rollback scenarios

   FAIL  Tests\Feature\Api\GamificationEdgeCasesTest
  ⨯ invalid action points award
  ⨯ negative or zero points handling
  ⨯ badge with expired availability
  ⨯ badge with future availability
  ⨯ max badge per user enforcement
  ⨯ level progression at maximum level
  ⨯ streak calculation edge cases
  ⨯ invalid badge criteria handling
  ⨯ leaderboard with tied scores
  ⨯ engagement score boundary conditions
  ⨯ api endpoints with missing beneficiary
  ⨯ large metadata handling
  ⨯ unicode and special characters
  ⨯ database constraint violations
  ⨯ api rate limiting behavior
  ⨯ memory cleanup after operations
  ⨯ progress percentage edge cases

   FAIL  Tests\Feature\Api\GamificationIntegrationTest
  ⨯ points accumulation across different activities
  ⨯ badge unlocking conditions and progression
  ⨯ leaderboard real time updates with proper ranking
  ⨯ concurrent user updates to leaderboard
  ⨯ level progression and milestone rewards
  ⨯ achievement notifications and activity feed
  ⨯ progress tracking across sessions
  ⨯ streak management and daily login bonuses
  ⨯ gamification analytics and reporting
  ⨯ edge cases and boundary conditions
  ⨯ gamification api endpoints integration
  ⨯ concurrent badge awards and race conditions

   FAIL  Tests\Feature\Api\GamificationPerformanceTest
  ⨯ leaderboard performance with large dataset
  ⨯ badge criteria evaluation performance
  ⨯ bulk point award performance
  ⨯ gamification api response times
  ⨯ database query optimization
  ⨯ memory usage with large datasets
  ⨯ concurrent operations performance
  ⨯ cache effectiveness for leaderboard
  ⨯ database connection efficiency
  ⨯ large badge collection performance
  ⨯ pagination performance for large datasets

   FAIL  Tests\Feature\Api\HealthCheckTest
  ⨯ health endpoint returns success when healthy
  ⨯ status endpoint returns detailed information
  ⨯ metrics endpoint returns application metrics
  ⨯ health check detects database issues
  ⨯ health check includes service response times
  ⨯ status endpoint includes version information
  ⨯ metrics endpoint includes error rates
  ⨯ health endpoints are publicly accessible
  ⨯ health check monitors all critical services
  ⨯ status endpoint includes uptime
  ⨯ metrics endpoint includes cache statistics
  ⨯ health check follows standard format
  ⨯ metrics endpoint includes queue performance

   FAIL  Tests\Feature\Api\InterviewSchedulingIntegrationTest
  ⨯ slot availability across timezones with validation
  ⨯ conflict detection and resolution with two hour buffer
  ⨯ notification delivery across multiple channels
  ⨯ rescheduling impact analysis on all parties
  ⨯ ai powered slot recommendations based on history
  ⨯ calendar synchronization with external systems
  ⨯ complex timezone handling across brazilian regions
  ⨯ concurrent booking race condition handling
  ⨯ notification preferences and delivery tracking
  ⨯ gamification integration with scheduling actions
  ⨯ interview history and analytics tracking
  ⨯ emergency cancellation and rescheduling workflows

   FAIL  Tests\Feature\Api\LGPDComplianceTest
  ⨯ user can export personal data json
  ⨯ user can export personal data pdf
  ⨯ user can delete account
  ⨯ account deletion requires correct password
  ⨯ account deletion requires confirmation phrase
  ⨯ user can get privacy settings
  ⨯ user can update privacy settings
  ⨯ user can get consent history
  ⨯ user can withdraw consent
  ⨯ user can get data processing activities
  ⨯ lgpd endpoints require authentication
  ⨯ lgpd endpoints require completed registration
  ⨯ lgpd endpoints require active account
  ⨯ data export is comprehensive
[2025-08-27T19:14:44.011Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:45.882Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:49.561Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:52.468Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db

   FAIL  Tests\Feature\Api\MultiRoleWorkflowIntegrationTest
  ⨯ complete multi role workflow
  ⨯ concurrent multi role operations
  ⨯ role permission boundaries
  ⨯ workflow rollback scenarios

   FAIL  Tests\Feature\Api\OCRGamificationIntegrationTest
  ⨯ it awards base points for successful ocr processing
  ⨯ it awards confidence bonus for high confidence processing
  ⨯ it awards medium confidence bonus
  ⨯ it awards quality bonuses
  ⨯ it awards validation success bonus
  ⨯ it awards partial validation bonus
  ⨯ it awards complex document bonus
  ⨯ it awards progressive quality bonus for consistent high quality
  ⨯ it does not award points for failed processing
  ⨯ it handles missing beneficiary gracefully
  ⨯ it calculates maximum possible points correctly
  ⨯ it integrates with document processed event correctly
  ⨯ gamification service calculates ocr points correctly
  ⨯ it logs gamification processing correctly
  ⨯ document processed event constructor works with all parameters

   FAIL  Tests\Feature\Api\RateLimitingTest
  ⨯ anonymous user rate limiting
  ⨯ authenticated user rate limiting
  ⨯ rate limiting headers
  ⨯ critical endpoint rate limiting
  ⨯ auth endpoint rate limiting
  ⨯ submission endpoint rate limiting
  ⨯ rate limiting per ip
  ⨯ rate limiting bypass for health check
  ⨯ rate limiting configuration
  ⨯ rate limiting with malformed requests
  ⨯ rate limiting recovery

   FAIL  Tests\Feature\Api\RegistrationTest
  ⨯ single step registration
  ⨯ registration fails with existing email
  ⨯ registration fails with existing cpf
  ⨯ multi step registration step1
  ⨯ multi step registration step2
  ⨯ multi step registration step3
  ⨯ step2 requires correct registration step
  ⨯ step3 requires correct registration step
  ⨯ get registration progress
  ⨯ cancel registration
  ⨯ cannot cancel completed registration
  ⨯ registration rolls back on error

   FAIL  Tests\Feature\Api\SchedulingMigrationIntegrityTest
  ⨯ existing interviews remain accessible after telemedicine upgrade
  ⨯ existing gamification progress preserved during migration
  ⨯ new scheduling features work alongside existing interviews
  ⨯ gamification rewards work for both legacy and new appointments
  ⨯ database schema migration maintains referential integrity
  ⨯ concurrent operations on mixed interview types
  ⨯ error handling maintains data consistency during transitions
  ⨯ performance regression test for mixed data queries
  ⨯ api backwards compatibility for existing clients
  ⨯ cache invalidation works correctly across interview types

   FAIL  Tests\Feature\Api\SecurityHeadersTest
  ⨯ security headers present
  ⨯ cors headers
  ⨯ content type enforcement
  ⨯ rate limit error response format

   FAIL  Tests\Feature\Api\SessionManagementTest
  ⨯ user can have multiple active sessions
  ⨯ logout only affects current session
  ⨯ logout from all devices
  ⨯ token expiration
  ⨯ concurrent sessions tracking
  ⨯ refresh token invalidates old token
  ⨯ session activity tracking
  ⨯ device specific token naming
  ⨯ http only cookie authentication
  ⨯ multiple logins same device updates token
  ⨯ token abilities

   FAIL  Tests\Feature\Api\SocialAuthenticationTest
  ⨯ redirect to google oauth
  ⨯ redirect to facebook oauth
  ⨯ redirect to instagram oauth
  ⨯ unsupported provider returns error
  ⨯ google oauth callback creates new user
  ⨯ google oauth callback links existing user
  ⨯ oauth callback returns existing user with social id
  ⨯ oauth callback creates user without email
  ⨯ oauth callback handles provider errors
  ⨯ facebook oauth creates user
  ⨯ instagram oauth through facebook

   FAIL  Tests\Feature\Api\TelemedicineIntegrationSecurityTest
  ⨯ unauthorized users cannot access interview endpoints
  ⨯ video session access control prevents unauthorized joining
  ⨯ sql injection protection in scheduling endpoints
  ⨯ xss protection in user input fields
  ⨯ csrf protection on state changing operations
  ⨯ sensitive data exposure prevention
  ⨯ video session encryption and hipaa compliance
  ⨯ rate limiting prevents api abuse
  ⨯ input validation prevents malformed data attacks
  ⨯ audit logging captures security events
  ⨯ session management prevents hijacking

   FAIL  Tests\Feature\Api\TelemedicineSchedulingTest
  ⨯ eligibility check with incomplete requirements
  ⨯ eligibility check with complete requirements
  ⨯ appointment types requires eligibility
  ⨯ get appointment types when eligible
  ⨯ get available slots for appointment type
  ⨯ book telemedicine appointment successfully
  ⨯ cannot book appointment when not eligible
  ⨯ cannot book unavailable slot
  ⨯ cannot book non telemedicine slot

   FAIL  Tests\Feature\Api\UnifiedAuthTest
  ⨯ it can login with email using unified auth service
  ⨯ it can login with cpf using unified auth service
  ⨯ it handles registration incomplete correctly
  ⨯ it rejects invalid credentials
  ⨯ it handles inactive users
  ⨯ it can logout using unified auth service
  ⨯ it can get authenticated user using unified auth service
  ⨯ it can refresh token using unified auth service
  ⨯ it can check email exists
  ⨯ it can check cpf exists
  ⨯ it implements rate limiting
[2025-08-27T19:14:56.581Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:14:59.137Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:15:00.956Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:15:02.800Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db
[2025-08-27T19:15:04.933Z] INFO [memory-store] Initialized SQLite at: /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/.swarm/memory.db

   FAIL  Tests\Feature\Api\UserJourneyEndToEndTest
  ⨯ complete user journey with progressive disclosure
  ⨯ role based access control transitions
  ⨯ cross feature data consistency
  ⨯ document processing pipeline with ocr fallback
  ⨯ progressive disclosure based on user progress

   FAIL  Tests\Feature\Api\VideoConferencingIntegrationTest
  ⨯ interview scheduling creates video session flow
  ⨯ video session recording management workflow
  ⨯ screen sharing permissions and validation
  ⨯ session persistence and recovery mechanisms
  ⨯ multi participant coordination workflow
  ⨯ bandwidth adaptation and quality settings
  ⨯ hipaa compliance and security validation
  ⨯ session timeout and auto cleanup
  ⨯ concurrent session management
  ⨯ recording access control and permissions
  ⨯ session analytics and quality monitoring
  ⨯ emergency session termination

   FAIL  Tests\Feature\Api\WebSocketRealTimeIntegrationTest
  ⨯ real time participant status updates
  ⨯ real time chat message broadcasting
  ⨯ real time screen sharing notifications
  ⨯ real time connection quality monitoring
  ⨯ real time recording status updates
  ⨯ real time session analytics dashboard
  ⨯ real time interview status notifications
  ⨯ real time emergency alerts and notifications
  ⨯ real time bandwidth adaptation notifications
  ⨯ real time multi session coordination
  ⨯ real time presence and heartbeat monitoring
  ⨯ real time collaborative features
  ⨯ real time session recovery and reconnection

   FAIL  Tests\Feature\DocumentControllerTest
  ⨯ it can get all documents for authenticated user
  ⨯ it can upload a document
  ⨯ it validates file upload requirements
  ⨯ it can get document details
  ⨯ it can generate download url
  ⨯ it can delete a document
  ⨯ it can trigger ocr processing
  ⨯ it prevents duplicate ocr processing
  ⨯ it can validate ocr results
  ⨯ it can get validation progress
  ⨯ it prevents unauthorized access to documents
  ⨯ it handles storage failures gracefully
  ⨯ it requires authentication for all endpoints

   FAIL  Tests\Feature\HealthQuestionnaireControllerTest
  ⨯ it can get questionnaire templates
  ⨯ it can start a new questionnaire
  ⨯ it prevents starting duplicate questionnaires
  ⨯ it validates template id when starting questionnaire
  ⨯ it can save questionnaire responses
  ⨯ it validates responses data
  ⨯ it can get questionnaire progress
  ⨯ it can get ai insights
  ⨯ it validates ai insights request
  ⨯ it handles ai service errors gracefully
  ⨯ it prevents unauthorized access to questionnaires
  ⨯ it completes questionnaire and calculates score
  ⨯ it requires authentication for all endpoints

   FAIL  Tests\Feature\OCRIntegrationTest
  ⨯ it can upload and queue ocr processing
  ⨯ it processes document ocr job successfully
  ⨯ it handles ocr processing failures gracefully
  ⨯ it tracks ocr usage correctly
  ⨯ it prevents processing when budget exceeded
  ⨯ it validates document data against beneficiary
  ⨯ it returns validation progress correctly
  ⨯ it handles concurrent processing safely

   FAIL  Tests\Feature\VideoConferencingTest
  ⨯ user can create video session
  ⨯ user can join existing session
  ⨯ user cannot access unauthorized session
  ⨯ healthcare professional can start recording
  ⨯ patient cannot start recording
  ⨯ user can enable screen sharing
  ⨯ session status provides analytics
  ⨯ user can end session
  ⨯ video security middleware blocks unauthorized access
  ⨯ video service handles vonage api failure
  ⨯ session health validation
  ⨯ session cost calculation

   FAIL  Tests\Integration\AIAndOCRIntegrationTest
  ⨯ it can detect health conditions through conversation and update questionnaire
  ⨯ it can process document with ocr and cross validate with beneficiary data
  ⨯ it can detect inconsistencies between documents and questionnaire responses
  ⨯ it can use ai to enhance ocr accuracy
  ⨯ it can generate comprehensive health profile from all data sources
  ⨯ it can handle complex document validation scenarios

   FAIL  Tests\Integration\OCRFallbackIntegrationTest
  ⨯ it can fallback to tesseract when textract fails
  ⨯ it can retry textract with exponential backoff
  ⨯ it can handle network timeout gracefully
  ⨯ it can handle aws quota exceeded
  ⨯ it can handle invalid document format
  ⨯ it can handle both services failing
  ⨯ it can validate service health before processing
  ⨯ it can prioritize service based on document type
  ⨯ it can handle concurrent processing failures
  ⨯ it can recover from partial failures

   FAIL  Tests\Performance\AdminPerformanceTest
  ⨯ admin user list loads within acceptable time
  ⨯ admin user search performance
  ⨯ admin bulk operations performance
  ⨯ admin dashboard metrics performance
  ⨯ admin report generation performance
  ⨯ admin concurrent operations performance
  ⨯ admin memory usage optimization
  ⨯ admin database query optimization
  ⨯ admin caching effectiveness
  ⨯ admin pagination performance
  ⨯ admin real time updates performance
  ⨯ admin export performance large datasets

   FAIL  Tests\Performance\ApiPerformanceTest
  ⨯ health endpoint performance
  ⨯ auth check email performance
  ⨯ authentication flow performance
  ⨯ concurrent request simulation
  ⨯ health questionnaire performance
  ⨯ rate limiting enforcement

   FAIL  Tests\Performance\ConcurrentLoadTest
  ⨯ concurrent health requests
  ⨯ rate limiting under load
  ⨯ database performance under load
  ⨯ memory usage under load

   FAIL  Tests\Performance\DatabasePerformanceTest
  ⨯ database connection performance
  ⨯ query performance with indexes
  ⨯ bulk operations performance
  ⨯ cache performance
  ⨯ health questionnaire query optimization
  ⨯ transaction performance

   FAIL  Tests\Performance\HealthQuestionnairePerformanceTest
  ⨯ it can handle concurrent questionnaire starts
  ⨯ it can handle large response payloads
  ⨯ it can handle multiple ai requests efficiently
  ⨯ it can handle database load with many questionnaires
  ⨯ it maintains response times under load
  ⨯ it can handle memory intensive operations
  ⨯ it can handle cache efficiency

   FAIL  Tests\Performance\OCRLoadTest
  ⨯ it can handle concurrent ocr requests
  ⨯ it can handle high volume document processing
  ⨯ it can handle memory pressure gracefully
  ⨯ it can maintain database performance under load

   FAIL  Tests\Performance\OCRPerformanceBenchmarkTest
  ⨯ it can benchmark textract vs tesseract processing speed
  ⨯ it can benchmark textract vs tesseract accuracy
  ⨯ it can benchmark confidence scores reliability
  ⨯ it can benchmark brazilian document specific accuracy
  ⨯ it can benchmark cost effectiveness

   FAIL  Tests\Performance\RateLimitLoadTest
  ⨯ concurrent requests with rate limiting
  ⨯ endpoint specific rate limiting
  ⨯ rate limiting by user type
  ⨯ rate limiting performance impact
  ⨯ rate limiting memory usage
  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\OpenTelemetryIntegrationTest > tracing service provide…   
  Failed asserting that an array contains 'App\Providers\TracingServiceProvider'.

  at tests/Unit/OpenTelemetryIntegrationTest.php:35
     31▕         $providers = config('app.providers');
     32▕         
     33▕         // Check if TracingServiceProvider class exists first
     34▕         if (class_exists(TracingServiceProvider::class)) {
  ➜  35▕             $this->assertContains(TracingServiceProvider::class, $providers);
     36▕         } else {
     37▕             // If the provider doesn't exist, skip this test
     38▕             $this->markTestSkipped('TracingServiceProvider class does not exist');
     39▕         }

  1   tests/Unit/OpenTelemetryIntegrationTest.php:35

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRCostMonitoringTest > it can track t…  Error   
  Call to undefined method Tests\Unit\Services\OCRCostMonitoringTest::getTextractFeatures()

  at tests/Unit/Services/OCRCostMonitoringTest.php:49
     45▕             
     46▕             $usageLog[] = [
     47▕                 'document_id' => $index + 1,
     48▕                 'pages' => $doc['pages'],
  ➜  49▕                 'features_used' => $this->getTextractFeatures($doc),
     50▕                 'cost_breakdown' => $docCost,
     51▕                 'timestamp' => now()->toISOString()
     52▕             ];
     53▕

  1   tests/Unit/Services/OCRCostMonitoringTest.php:49

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRCostMonitoringTest > it can monitor daily…    
  Should generate warnings when approaching limits
Failed asserting that an array is not empty.

  at tests/Unit/Services/OCRCostMonitoringTest.php:117
    113▕             }
    114▕         }
    115▕         
    116▕         // Verify limit monitoring
  ➜ 117▕         $this->assertNotEmpty($warnings, 'Should generate warnings when approaching limits');
    118▕         
    119▕         $currentSpending = $this->costMonitor->getCurrentDailySpending();
    120▕         $this->assertLessThanOrEqual($dailyLimit, $currentSpending, 'Should not exceed daily limit');
    121▕

  1   tests/Unit/Services/OCRCostMonitoringTest.php:117

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRCostMonitoringTest > it can track c…  Error   
  Call to undefined method Tests\Unit\Services\OCRCostMonitoringTest::generateDocumentSamples()

  at tests/Unit/Services/OCRCostMonitoringTest.php:197
    193▕         $typeAnalysis = [];
    194▕         
    195▕         foreach ($documentTypes as $type) {
    196▕             // Simulate processing different document types
  ➜ 197▕             $samples = $this->generateDocumentSamples($type, 20);
    198▕             $typeCosts = [];
    199▕             
    200▕             foreach ($samples as $sample) {
    201▕                 $textractCost = $this->costMonitor->calculateTextractCost($sample);

  1   tests/Unit/Services/OCRCostMonitoringTest.php:197

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRServiceTest > it can extra…  ErrorException   
  Undefined array key 1

  at app/Services/OCRService.php:285
    281▕         $text = $ocrData['raw_text'];
    282▕         
    283▕         // Extract address patterns
    284▕         if (preg_match('/rua|av|avenida|alameda[:\s]*([^,\n]+)/i', $text, $matches)) {
  ➜ 285▕             $data['street'] = trim($matches[1]);
    286▕         }
    287▕ 
    288▕         // Extract CEP
    289▕         if (preg_match('/(\d{5}-?\d{3})/', $text, $matches)) {

  1   app/Services/OCRService.php:164
  2   tests/Unit/Services/OCRServiceTest.php:119

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRServiceTest > it validates identity docume…   
  Failed asserting that 70.0 is greater than 70.

  at tests/Unit/Services/OCRServiceTest.php:141
    137▕         $validation = $this->ocrService->validateExtractedData('rg', $extractedData, $this->beneficiary);
    138▕ 
    139▕         $this->assertTrue($validation['is_valid']);
    140▕         $this->assertEmpty($validation['errors']);
  ➜ 141▕         $this->assertGreaterThan(70, $validation['confidence_score']);
    142▕     }
    143▕ 
    144▕     /** @test */
    145▕     public function it_detects_name_mismatch_in_validation()

  1   tests/Unit/Services/OCRServiceTest.php:141

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRServiceTest > it validates cpf document co…   
  Failed asserting that false is true.

  at tests/Unit/Services/OCRServiceTest.php:182
    178▕         ];
    179▕ 
    180▕         $validation = $this->ocrService->validateExtractedData('cpf', $extractedData, $this->beneficiary);
    181▕ 
  ➜ 182▕         $this->assertTrue($validation['is_valid']);
    183▕         $this->assertGreaterThan(70, $validation['confidence_score']);
    184▕     }
    185▕ 
    186▕     /** @test */

  1   tests/Unit/Services/OCRServiceTest.php:182

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRServiceTest > it detects cpf mismatch         
  Failed asserting that an array contains 'CPF do documento não confere'.

  at tests/Unit/Services/OCRServiceTest.php:197
    193▕ 
    194▕         $validation = $this->ocrService->validateExtractedData('cpf', $extractedData, $this->beneficiary);
    195▕ 
    196▕         $this->assertFalse($validation['is_valid']);
  ➜ 197▕         $this->assertContains('CPF do documento não confere', $validation['errors']);
    198▕     }
    199▕ 
    200▕     /** @test */
    201▕     public function it_validates_address_document_with_warnings()

  1   tests/Unit/Services/OCRServiceTest.php:197

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OCRServiceTest > it validates address documen…   
  Failed asserting that 0 is greater than 50.

  at tests/Unit/Services/OCRServiceTest.php:212
    208▕ 
    209▕         $validation = $this->ocrService->validateExtractedData('comprovante_residencia', $extractedData, $this->beneficiary);
    210▕ 
    211▕         $this->assertTrue($validation['is_valid']);
  ➜ 212▕         $this->assertGreaterThan(50, $validation['confidence_score']);
    213▕     }
    214▕ 
    215▕     /** @test */
    216▕     public function it_detects_expired_cnh_document()

  1   tests/Unit/Services/OCRServiceTest.php:212

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedText…  NoMatchingExpectationException   
  No matching handler found for Mockery_7_App_Services_TextractCostOptimizationService::estimateProcessingCost('optimized-document.jpg'). Either the method was unexpected or its arguments matched no expected argument list for this method

  at app/Services/OptimizedTextractService.php:58
     54▕         }
     55▕ 
     56▕         try {
     57▕             // Estimate cost before processing
  ➜  58▕             $estimatedCost = $this->costService->estimateProcessingCost($optimizedFile);
     59▕             
     60▕             // Process with Textract
     61▕             $result = $this->processWithTextractOptimized($optimizedFile, $options);
     62▕

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:108

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServ…  BadMethodCallException   
  Received Mockery_10_App_Services_OptimizedTextractService::detectDocumentType(), but no expectations were specified

  at tests/Unit/Services/OptimizedTextractServiceTest.php:276
    272▕         if ($methodName === 'detectDocumentType') {
    273▕             $this->mockImageCreation($args[0]);
    274▕         }
    275▕ 
  ➜ 276▕         return $method->invoke($this->service, ...$args);
    277▕     }
    278▕ 
    279▕     /**
    280▕      * Mock Textract response

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:276
  2   tests/Unit/Services/OptimizedTextractServiceTest.php:166

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServ…  BadMethodCallException   
  Received Mockery_10_App_Services_OptimizedTextractService::selectOptimalFeatures(), but no expectations were specified

  at tests/Unit/Services/OptimizedTextractServiceTest.php:276
    272▕         if ($methodName === 'detectDocumentType') {
    273▕             $this->mockImageCreation($args[0]);
    274▕         }
    275▕ 
  ➜ 276▕         return $method->invoke($this->service, ...$args);
    277▕     }
    278▕ 
    279▕     /**
    280▕      * Mock Textract response

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:276
  2   tests/Unit/Services/OptimizedTextractServiceTest.php:180

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServiceTest > it hand…  Error   
  Class "Aws\Exception\AwsException" not found

  at tests/Unit/Services/OptimizedTextractServiceTest.php:198
    194▕     /** @test */
    195▕     public function it_handles_throttling_exception_with_exponential_backoff()
    196▕     {
    197▕         $filePath = 'test-document.jpg';
  ➜ 198▕         $exception = new AwsException('Rate exceeded', Mockery::mock(\GuzzleHttp\Command\CommandInterface::class));
    199▕         $exception->setAwsErrorCode('ThrottlingException');
    200▕ 
    201▕         // First attempt should retry with backoff
    202▕         $result = $this->invokePrivateMethod('handleTextractError', $exception, $filePath, []);

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:198

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServ…  BadMethodCallException   
  Received Mockery_10_App_Services_OptimizedTextractService::formatCPF(), but no expectations were specified

  at tests/Unit/Services/OptimizedTextractServiceTest.php:276
    272▕         if ($methodName === 'detectDocumentType') {
    273▕             $this->mockImageCreation($args[0]);
    274▕         }
    275▕ 
  ➜ 276▕         return $method->invoke($this->service, ...$args);
    277▕     }
    278▕ 
    279▕     /**
    280▕      * Mock Textract response

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:276
  2   tests/Unit/Services/OptimizedTextractServiceTest.php:212

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServ…  BadMethodCallException   
  Received Mockery_10_App_Services_OptimizedTextractService::calculateQualityMetrics(), but no expectations were specified

  at tests/Unit/Services/OptimizedTextractServiceTest.php:276
    272▕         if ($methodName === 'detectDocumentType') {
    273▕             $this->mockImageCreation($args[0]);
    274▕         }
    275▕ 
  ➜ 276▕         return $method->invoke($this->service, ...$args);
    277▕     }
    278▕ 
    279▕     /**
    280▕      * Mock Textract response

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:276
  2   tests/Unit/Services/OptimizedTextractServiceTest.php:231

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\OptimizedTextractServiceTest > it hand…  Error   
  Class "Aws\Exception\AwsException" not found

  at tests/Unit/Services/OptimizedTextractServiceTest.php:248
    244▕     /** @test */
    245▕     public function it_handles_unsupported_document_exception()
    246▕     {
    247▕         $filePath = 'test-document.pdf';
  ➜ 248▕         $exception = new AwsException('Document format not supported', Mockery::mock(\GuzzleHttp\Command\CommandInterface::class));
    249▕         $exception->setAwsErrorCode('UnsupportedDocumentException');
    250▕ 
    251▕         // Mock Tesseract fallback
    252▕         $this->tesseractService->shouldReceive('processDocument')

  1   tests/Unit/Services/OptimizedTextractServiceTest.php:248

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractCostOptimizationServiceTes…  TypeError   
  App\Services\TextractCostOptimizationService::__construct(): Argument #1 ($cache) must be of type Illuminate\Contracts\Cache\Repository, Mockery_3_App_Services_OCRUsageTracker given, called in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractCostOptimizationServiceTest.php on line 26

  at app/Services/TextractCostOptimizationService.php:30
     26▕     protected $cache;
     27▕     protected $usageTracker;
     28▕     protected $config;
     29▕ 
  ➜  30▕     public function __construct(CacheRepository $cache, OCRUsageTracker $usageTracker)
     31▕     {
     32▕         $this->cache = $cache;
     33▕         $this->usageTracker = $usageTracker;
     34▕         $this->config = Config::get('ocr');

  1   app/Services/TextractCostOptimizationService.php:30
  2   tests/Unit/Services/TextractCostOptimizationServiceTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  17▕     public function __construct(
     18▕         BrazilianDocumentService $documentService,
     19▕         ValidationUtilityService $validationService
     20▕     ) {
     21▕         $this->textractClient = new TextractClient([

  1   app/Services/OCRService.php:17
  2   tests/Unit/Services/TextractServiceTest.php:30

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Services\TextractServiceTest > it…   ArgumentCountError   
  Too few arguments to function App\Services\OCRService::__construct(), 0 passed in /Users/rodrigo/claude-projects/OnboardingPortal/omni-portal/backend/tests/Unit/Services/TextractServiceTest.php on line 30 and exactly 2 expected

  at app/Services/OCRService.php:17
     13▕     protected $textractClient;
     14▕     protected BrazilianDocumentService $documentService;
     15▕     protected ValidationUtilityService $validationService;
     16▕ 
  ➜  